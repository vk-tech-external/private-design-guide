# {heading(Системы хранения данных)[id=data_storage]}

## {heading(Ceph)[id=data_storage_ceph]}

Ceph является основным вариантом реализации системы хранения данных для облачной платформы VK. Используется Ceph версии Octopus, без кастомных доработок. Формируются кластеры от 3 до 9 узлов. При необходимости использования большего количества серверов хранения, из них формируется несколько кластеров.

Особенности:

* Ceph генерирует большой объем трафика, поэтому для внутреннего взаимодействия компонентов используется отдельная сеть (VLAN), развернутая на отдельных сетевых интерфейсах — как в случае с 10 Гбит/с интерфейсами, так и с более производительными вариантами.
* Ceph не требует высокопроизводительных процессоров, но требует достаточно большой объем оперативной памяти.
* Не используется RAID. Диски отдаются в Ceph индивидуально, один диск = один Ceph OSD. В отдельных случаях, например, для NVMe дисков — два ceph OSD на диск.
* Надежность хранения данных обеспечивается за счет троекратной репликации данных по серверам кластера Ceph.

Минимальное количество узлов Ceph — 3 сервера. Добавлять допустимо количество серверов, кратное трем. Допустимо использовать различные диски в разных кластерах Ceph для обеспечения различных уровней производительности.

Базовая конфигурация:

* 2x Intel Xeon Silver 4210R
* 128 Гбайт ОЗУ
* 2x480 Гбайт SSD, 6x7.68 Тбайт SSD
* 4х25Gb или 4x10Gb (2x LACP)

## {heading(High-IOPS Storage)[id=data_storage_highiops]}

Быстрое хранилище реализовано на базе NVMe дисков без защиты от выхода из строя отдельных серверов.

Отказоустойчивость хранения данных обеспечивается за счет LVM Mirror. Взаимодействие с {var(system)} осуществляется с использованием протокола `iSCSI`. Серверы High-IOPS Storage работают индивидуально, без кластеризации. Их количество в инсталляции может быть произвольным. Возможно совмещение роли с Compute-серверами.

Базовая конфигурация:

* 2x Intel Xeon Silver 4210R
* 128 Гбайт ОЗУ
* 2x480 Гбайт SSD, 6x7.68 Тбайт NVMe
* 2х25Gb или 2x10Gb (2x LACP)

## {heading(Готовые СХД)[id=data_storage_sdh]}

Возможно использование {var(system)} со сторонними СХД:

* На данный момент поддерживаются HP 3PAR серии 8000: тестирование проводилось на модели 8400.
* Поддержка Huawei Dorado и Lenovo/IBM находится в разработке.
* По запросу возможно тестирование и доработка для поддержки других СХД (при большом заказе или интересе нескольких клиентов).

При использовании готовой СХД не используется сеть Ceph Internal. Сеть Ceph External заменяется сеть Storage с аналогичными требованиями.