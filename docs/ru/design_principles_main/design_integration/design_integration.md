# {heading(Интеграции)[id=design_integration]}

Для работы {var(sys2)} требуется обеспечить доступ к следующим службам, расположенным в корпоративной сети Заказчика:

* NTP.
* LDAP.
* DNS.

Для всех перечисленных служб необходимо получить данные для взаимодействия:

* Адреса серверов.
* Номера портов (в случае использования нестандартных).
* Данные для аутентификации и запроса информации в LDAP/AD.

Для обеспечения корректной и стабильной работы {var(sys2)} к службам предъявляются следующие требования:

* Должны быть постоянно доступны.
* Отвечать на запросы с минимальной задержкой.

## {heading(NTP)[id=design_integration_ntp]}

Со службой точного времени будет выполняться синхронизация времени на серверах {var(sys2)}.

В качестве службы синхронизации времени могут быть использованы:

* Существующие NTP-серверы Заказчика.
* Выделенные для {var(sys2)} NTP-серверы с доступом к эталонному источнику времени.

## {heading(LDAP)[id=design_integration_ldap]}

Служба каталогов используется в качестве единой базы пользователей и групп для аутентификации. Возможно использование {var(sys2)} без интеграции с данной службой, но в большинстве случаев интеграция входит в требования Заказчика.

## {heading(DNS)[id=design_integration_dns]}

DNS необходим для корректного сетевого взаимодействия между компонентами {var(sys2)} и доступа к управляющим интерфейсам.

Рекомендуется выбрать основной домен для установки вида `vkc.domain.tld`. Здесь `domain.tld` — домен, используемый у Заказчика. Основной домен может быть как третьего, так и более высокого уровня.

Компоненты {var(sys2)} требуют дополнительных FQDN для своей работы. Они выделяются в поддомене {var(sys2)}.

В {linkto(#tab_list_of_control_and_service_components)[text=таблице %number]} приведен список управляющих и служебных компонентов {var(sys2)} и пример FQDN. Все перечисленные доменные имена должны иметь соответствующие записи в DNS Заказчика.

{caption(Таблица {counter(table)[id=numb_tab_list_of_control_and_service_components]} — Список управляющих и служебных компонентов {var(sys2)} с примерами FQDN)[align=right;position=above;id=tab_list_of_control_and_service_components;number={const(numb_tab_list_of_control_and_service_components)}]}
[cols="2,1", options="header"]
|===
|Компонент
|Пример FQDN

|Портал самообслуживания
|`lk.vkc.domain.tld`

|Портал администратора
|`admin.vkc.domain.tld`

|Портал управления доступом (Keycloak)
|`keycloak.vkc.domain.tld`

|Портал мониторинга (Zabbix)
|`mon.vkc.domain.tld`

|Портал просмотра журналов событий (OpenSearch)
|`logs.vkc.domain.tld`

|Katana DRS
|`katana.vkc.domain.tld`

|Внутренний эндпойнт Katana API
|`int-katana.vkc.domain.tld`

|Репозиторий пакетов для {var(sys2)} и PaaS-сервисов
|`repo.vkc.domain.tld`

|Репозиторий образов Docker для {var(sys2)} и PaaS-сервисов
|`registry.vkc.domain.tld`

|Внутренний интерфейс взаимодействия компонентов
|`internal.vkc.domain.tld`

|Внешний эндпойнт Cloud Monitoring API
|`cloudmon.vkc.domain.tld`

|Внешний эндпойнт Cloud Logging API
|`cloudlogs.vkc.domain.tld`
|===
{/caption}

Помимо перечисленных записей в DNS Заказчика для всех серверов {var(sys2)} должны быть заведены записи вида `hostname.vkc.test.domain`, соответствующие IP-адресу хоста в сети Management.

Для доступа к управляющим интерфейсам {var(sys2)} используется протокол HTTPS с шифрованием данных. Для его работы требуется генерация сертификатов. Сертификат должен быть выпущен центром сертификации и содержать полную цепочку сертификатов центров сертификации, выдавших его. Для выпуска сертификатов можно использовать как общедоступные центры сертификации, так и собственный (непубличный) центр сертификации Заказчика. В случае использования непубличного центра сертификации потребуется добавление сертификата CA в список доверенных при подготовке образов для компонентов VK Magnum (K8s-aaS) и Marketplace.

<warn>

Рекомендуется использовать Wildcard-сертификаты для используемых FQDN.

Использование сертификатов с конечным списком имен возможно, но может в дальнейшем создать трудности при установке новых компонентов {var(sys2)}.

</warn>

Рекомендуемый список доменов для запрашиваемых сертификатов:

* `vkc.domain.tld`.
* `*.vkc.domain.tld`.
