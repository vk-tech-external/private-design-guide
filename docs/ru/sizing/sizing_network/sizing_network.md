# {heading(Сайзинг сети)[id=sizing_network]}

## {heading(Адресное пространство сети)[id=sizing_network_address_space]}

Для работы {var(system)} требуется набор подсетей, которые будут являться уникальными в рамках корпоративной сети заказчика. При этом только часть подсетей будет маршрутизироваться в корпоративную сеть:

* Все сети класса Cloud External.
* Управляющие и транспортные сети:
   * Management
   * Public API Transport,
   * Public API Loopback,
   * Private API Loopback.

Адреса перечисленных сетей должны выбираться исходя из правил адресации корпоративной сети, остальные сети по согласованию с заказчиком можно выбирать из любых диапазонов, закрепленных за приватными сетями.

Размерность подсетей должна выбираться с учетом планируемого роста инсталляции в ближайшие 3-5 лет, при этом крайне не рекомендуется использовать подсети размерностью более /24. Начиная с инсталляций в 100-150 гипервизоров разделение платформы на несколько зон доступности из опционального переходит в разряд обязательных мер.

Рекомендации по выбору размерности:

* Использование /24 подсетей удобно и является лучшей практикой, но не всегда разумно с точки зрения эффективного использования адресного пространства. При необходимости можно использовать сети меньшей размерности.
* Сети Public API Transport, Public API Loopback и Private API Loopback рекомендуется делать размерностью /29.
* Для сетей Ceph Internal и Ceph External разумной размерностью является /26 при размерности основных сетях /24.

В некоторых случаях при наличии в поставке платформы объектного хранилища S3 от VK может потребоваться включение серверов хранилища в сеть Management для обеспечения работы мониторинга — это необходимо учесть на этапе проектирования.

На особом положении находятся сети класса Cloud External:

* Их размерность не ограничивается /24 — её необходимо закладывать исходя из планируемых требований к количеству внешних адресов ВМ.
* В отличие от остальных сетей, эти сети могут содержать в себе множество подсетей и их добавление можно производить и после запуска платформы в эксплуатацию.
* Помимо подсетей, возможно создать и несколько сетей этого класса. Например, для разделения ландшафтов на продуктивный, предрепродуктивный, тестовый и отладочный.

## {heading(Емкость сетевого оборудования)[id=sizing_network_space_capacity]}

Для обеспечения отказоустойчивости применяется агрегация линков с использованием протокола LACP. При этом необходимо использовать пару коммутаторов, распределяя линки агрегатов по ним.

Рекомендуется также выделить отдельный коммутатор (требования к поддержке LACP на него не распространяются) для сетей `IPMI` в случае их использования. При этом используется оборудование со скоростью интерфейсов 1 Гбит/с.

Также на отдельную пару коммутаторов рекомендуется вынести сеть доступа к СХД (Ceph External/Storage) и внутрикластерную сеть СХД (Ceph Internal). Так как на машины, выделенные для СХД подается и сеть Management, необходимо будет предусмотреть подачу ее на коммутаторы СХД или выделить дополнительную пару интерфейсов на серверах СХД (достаточно производительности 1 Гбит/с), которые будут заведены на основные коммутаторы.

Количество портов используемых коммутаторов определяется доступностью оборудования и экономической целесообразностью. Разумно заложить портовую емкость с учетом планируемого развития инсталляции.